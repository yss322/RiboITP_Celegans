x = log(
average)
)) +
geom_histogram(bin = 50)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bin = 60)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bin = 1000)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bin = 5)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bins = 5)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bins = 200)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bins = 100)
ggplot(raw_embryo_poly_avg,
aes(
x = log(
average)
)) +
geom_histogram(bins = 75)
ggplot(raw_embryo_poly_avg,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
ggplot(raw_embryo_poly_avg,
aes(
x = log3(
average)
)) +
geom_histogram(bins = 75)
ggplot(raw_embryo_poly_avg,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
raw_embryo_poly_avg [,average := average >5]
ggplot(raw_embryo_poly_avg,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
View(raw_embryo_poly_avg)
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg [,average > 5]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg [average > 5,]
ggplot(raw_embryo_poly_avg,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
View(raw_embryo_poly_avg)
raw_embryo_poly_avg [average > 5,]
raw_embryo_poly_avg <-raw_embryo_poly_avg [average > 5,]
ggplot(raw_embryo_poly_avg,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
library(ribor)
library(tidyverse)
library(edgeR)
library(data.table)
library(ggpubr)
library(stack)
library(EnhancedVolcano)
library(biomaRt)
color.palette0 = colorRampPalette(c("#98abc5", "#8a89a6", "#7b6888", "#6b486b", "#a05d56", "#d0743c", "#ff8c00"), space="Lab")
original.ribo <- Ribo("data/celegans_duplicate_allstages.ribo")
original.ribo
ribo_one_two_cell<- get_region_counts(original.ribo,
range.lower = 25,
range.upper = 35,
experiment = c('1cell_A','1cell_B','2cell_B'),
length      = TRUE,
transcript  = FALSE,
tidy = F,
region      = c("CDS") )
ribo_two_cell_A <-  get_region_counts(original.ribo,
range.lower = 28,
range.upper = 38,
experiment = c('2cell_A'),
length      = TRUE,
transcript  = FALSE,
tidy = F,
region      = c("CDS") )
ribo_one_two_cell<- as.data.table(ribo_one_two_cell)
ribo_two_cell_A <-as.data.table(ribo_two_cell_A)
ribo_one_two_cell [,CDS := (CDS+1)]
ribo_two_cell_A [,CDS := (CDS+1)]
rcw_diff_one_two = dcast(ribo_one_two_cell, transcript ~ experiment)
rcw_diff_two_A = dcast(ribo_two_cell_A, transcript ~ experiment)
rcw_diff_ribo = inner_join(rcw_diff_one_two,rcw_diff_two_A, by = "transcript")
#processing RNA-seq
rnaseq_diff <- get_rnaseq(ribo.object = original.ribo,
tidy        = F,
compact = F,
experiment = c('1cell_A','1cell_B','2cell_A','2cell_B'),
region = "CDS")
rnaseq_diff <- as.data.table(rnaseq_diff)
rnaseq_w_diff = dcast(rnaseq_diff, transcript ~ experiment)
all_counts_diff = merge(rnaseq_w_diff, rcw_diff_ribo, by= "transcript")
# Extract the gene name using strsplit and data.table
all_counts_diff <- all_counts_diff[, transcript := as.character(transcript)]
all_counts_diff[, gene_name := sapply(strsplit(transcript, "gene_symbol:"), function(x) tail(x, n = 1))]
all_counts_diff [,"transcript":= NULL ]
all_counts_diff <- setcolorder(all_counts_diff, "gene_name")
exptype <- factor(c("onecell.RNA","onecell.RNA",
"twocell.RNA","twocell.RNA",
"onecell.Ribo","onecell.Ribo","twocell.Ribo",
"twocell.Ribo" )  )
y <- DGEList(counts=all_counts_diff[,-1],
group=exptype, genes = all_counts_diff[,1])
keep <- filterByExpr(y)
y <- y[keep,,keep.lib.sizes=FALSE]
y <- calcNormFactors(y, method = "TMM")
design <- model.matrix(~0+exptype)
colnames(design) <- levels(exptype)
y <- estimateDisp(y,design)
fit <- glmQLFit(y,design)
my.contrasts <- makeContrasts(
TE_onecellvstwocell = (twocell.Ribo - twocell.RNA) - (onecell.Ribo - onecell.RNA) ,
Ribo_onevstwo =  twocell.Ribo - onecell.Ribo  ,
RNA_onevstwo = twocell.RNA - onecell.RNA ,
levels = design
)
qlf <- glmQLFTest(fit, contrast=my.contrasts[,"RNA_onevstwo"])
qlf <- glmQLFTest(fit, contrast=my.contrasts[,"Ribo_onevstwo"])
qlf <- glmQLFTest(fit, contrast=my.contrasts[,"TE_onecellvstwocell"])
toplist<-as.data.table(topTags(qlf, n =inf,))
toplist<-as.data.table(topTags(qlf, n =Inf,))
View(toplist)
listofgenes<- qlf$genes
View(listofgenes)
#converting to wormbase annotations using biomart
ensembl = useDataset("hsapiens_gene_ensembl",mart=ensembl)
library(biomaRt)
#converting to wormbase annotations using biomart
ensembl = useDataset("celegans_gene_ensembl",mart=ensembl)
#converting to wormbase annotations using biomart
ensembl <- useDataset("celegans_gene_ensembl",mart=ensembl)
#converting to wormbase annotations using biomart
listMarts()
useMart(ensemble)
useMart("ensembl")
ensembl <- useDataset("celegans_gene_ensembl",mart=ensembl)
ensembl<-useMart("ensembl")
ensembl <- useDataset("celegans_gene_ensembl",mart=ensembl)
listFilters(ensembl)
filers<-listFilters(ensembl)
view(filers)
raw_embryo_poly_avg <- raw_embryo_poly_a[, Name := tstrsplit(column_to_split, "/" ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, Name := tstrsplit(column_to_split, "/") ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, Name := tstrsplit(Name, "/") ]
View(raw_embryo_poly_avg)
raw_embryo_poly_avg <- raw_embryo_poly_a[,c("c1","c2") := tstrsplit(Name, "/") ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, tstrsplit(Name, "/") := c("c1","c2")  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=tstrsplit(Name, "/")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=strsplit(Name, "/")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, strsplit(Name, "/")   ]
View(raw_embryo_poly_avg)
raw_embryo_poly_avg <- raw_embryo_poly_a[, Name := strsplit(Name, "/")   ]
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, Name := strsplit(Name, "/")   ]
View(raw_embryo_poly_avg)
View(raw_embryo_poly_a)
View(raw_poly_a)
raw_poly_a <- as.data.table (read.csv(file = "data/GSE68002_tail-count.csv"))
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
View(raw_embryo_poly_a)
raw_embryo_poly_avg <- raw_embryo_poly_a[, Name := strsplit(Name, "/")   ]
View(raw_embryo_poly_avg)
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c(c1,c2)<- strsplit(Name, "/")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2")<- strsplit(Name, "/")   ]
?strsplit
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2")<- tstrsplit(Name, "/",fixed = TRUE)   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2")<:=tstrsplit(Name, "/",fixed = TRUE)   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=tstrsplit(Name, "/",fixed = TRUE)   ]
raw_poly_a <- as.data.table (read.csv(file = "data/GSE68002_tail-count.csv"))
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=tstrsplit(Name, "/",fixed = TRUE)   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=tstrsplit(Name, "/NM_")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=strsplit(Name, "/NM_")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, c("c1","c2"):=strsplit(Name, "/")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, strsplit(Name, "/")   ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, strsplit(Name, "/")[[1]][2]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, strsplit(Name, "/")[[1]][1]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, strsplit(Name, "/")[[1]][1]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, strsplit(Name, "/")[1]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ strsplit(Name, "/")[1] , ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,strsplit(Name, "/")[1]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,strsplit(Name, "/")[[1]]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := strsplit(Name, "/")[[1]]  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/"),1)  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/",1)  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/",1))  ]
View(raw_embryo_poly_avg)
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/",1))  ]
View(raw_embryo_poly_avg)
View(raw_embryo_poly_a)
View(raw_poly_a)
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (tstrsplit(Name, "/",1))  ]
raw_poly_a <- as.data.table (read.csv(file = "data/GSE68002_tail-count.csv"))
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (tstrsplit(Name, "/",1))  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/",1))  ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/",2))  ]
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
raw_embryo_poly_avg <- raw_embryo_poly_a[ ,Name := (strsplit(Name, "/",2))  ]
ggplot(raw_embryo_poly_avg,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
raw_embryo_poly_a[, first_gene_id := sapply(strsplit(gene_ids, "/"), function(x) x[1])]
raw_embryo_poly_a[, first_gene_id := sapply(strsplit(Name, "/"), function(x) x[1])]
# Define a function to extract the first part
extract_first_part <- function(gene_id) {
split_gene_id <- unlist(strsplit(gene_id, "/"))
return(split_gene_id[1])
}
raw_embryo_poly_a[first_gene_id := sapply(Name, extract_first_part)]
raw_embryo_poly_a[,first_gene_id := sapply(Name, extract_first_part)]
View(raw_embryo_poly_a)
raw_embryo_poly_a[,Name := sapply(Name, extract_first_part)]
View(raw_embryo_poly_a)
raw_poly_a <- as.data.table (read.csv(file = "data/GSE68002_tail-count.csv"))
raw_embryo_poly_a<- raw_poly_a[,.(Name,X1.2.cell.egg.rep1,X1.2.cell.egg.rep2)]
raw_embryo_poly_a[,Name := sapply(Name, extract_first_part)]
View(raw_embryo_poly_a)
raw_embryo_poly_avg <- raw_embryo_poly_a[, average := ((X1.2.cell.egg.rep1 + X1.2.cell.egg.rep2)/2) ]
View(raw_embryo_poly_avg)
#converting to wormbase annotations using biomart
listMarts()
ensembl<-useMart("ensembl")
ensembl <- useDataset("celegans_gene_ensembl",mart=ensembl)
filters<-listFilters(ensembl)
geneIDs <- raw_embryo_poly_avg[,1]
View(geneIDs)
listAttributes(ensembl)
attributes <- listAttributes()
attributes <- listAttributes(ensembl)
View(attributes)
getBM(attributes = c("external_gene_name","wormbase_gene"),
filters = "refseq_mrna",
values = geneIDs,
mart = ensembl)
results<- getBM(attributes = c("external_gene_name","wormbase_gene"),
filters = "refseq_mrna",
values = geneIDs,
mart = ensembl)
View(results)
results<- getBM(attributes = c("external_gene_name","wormbase_gene","refseq_mrna"),
filters = "refseq_mrna",
values = geneIDs,
mart = ensembl)
View(results)
results<- getBM(attributes = c("external_gene_name","refseq_mrna"),
filters = "refseq_mrna",
values = geneIDs,
mart = ensembl)
results<- as.data.table(getBM(attributes = c("external_gene_name","refseq_mrna"),
filters = "refseq_mrna",
values = geneIDs,
mart = ensembl))
results[,Name:=refseq_mrna]
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg)
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg, by = Name
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg, by = Name)
results[,Name:=refseq_mrna]
View(results)
results[,.(Name:=refseq_mrna)]
results[,Name:=refseq_mrna]
view(results)
results[,-(refseq_mrna)]
results[,-.(refseq_mrna)]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,-c(refseq_mrna,Name)]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,-embyro_polya_wormbaseIDs[refseq_mrna,Name]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,-embyro_polya_wormbaseIDs[refseq_mrna,Name]]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,c(refseq_mrna,Name):=NULL]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,c(refseq_mrna,Name):= NULL]
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,c(Name):= NULL]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!c(Name,refseq_mrna)
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!c(Name,refseq_mrna)]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!(Name)]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!Name]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!(Name)]
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!("Name")]
embyro_polya_wormbaseIDs  <- embyro_polya_wormbaseIDs [average > 5,]
View(embyro_polya_wormbaseIDs)
ggplot(embyro_polya_wormbaseIDs,
aes(
x = log2(
average)
)) +
geom_histogram(bins = 75)
view(all_counts_diff)
view(all_counts_diff)
one_cell_ribo <- all_counts_diff[,.("1cell_A.y","1cell_B.y")]#checking with one cell stage first
view(one_cell_ribo)
one_cell_ribo <- all_counts_diff[,.(1cell_A.y,1cell_B.y)]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,all_counts_diff[1]]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,all_counts_diff[1][2]]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,all_counts_diff[1][6][7]]#checking with one cell stage first
View(one_cell_ribo)
one_cell_ribo <- all_counts_diff[,all_counts_diff[,1][,6][,7]]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,all_counts_diff[,(1,6])#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,all_counts_diff[,c(1,6)]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,all_counts_diff[,c(1,6)]]#checking with one cell stage first
View(one_cell_ribo)
one_cell_ribo <- all_counts_diff[,all_counts_diff[,c(1,2.3)]]#checking with one cell stage first
View(one_cell_ribo)
one_cell_ribo <- all_counts_diff[,c(1,2.3)]]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,c(1,2.3)]#checking with one cell stage first
View(one_cell_ribo)
one_cell_ribo <- all_counts_diff[,c(1,2,3)]#checking with one cell stage first
one_cell_ribo <- all_counts_diff[,c(1,6,7)]#checking with one cell stage first
one_cell_ribo_avg <- one_cell_ribo[,average := (one_cell_ribo[,2]+one_cell_ribo[,3])]
View(one_cell_ribo_avg)
one_cell_ribo_avg <- one_cell_ribo[,average := ((one_cell_ribo[,2]+one_cell_ribo[,3])/2)]
View(one_cell_ribo_avg)
one_cell_ribo_avg[average >5,]
one_cell_ribo_avg<- one_cell_ribo_avg[average >5,]
View(one_cell_ribo_avg)
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs[,external_gene_name:="gene_name"]
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg, by = Name)
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!c("Name")]
embyro_polya_wormbaseIDs[,"external_gene_name":="gene_name"]
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg, by = Name)
D
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg, by = Name)
results[,Name:=refseq_mrna]
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg, by = Name)
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg)
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!c("Name")]
embyro_polya_wormbaseIDs[,gene_name := external_gene_name]
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!c("Name")]
embyro_polya_wormbaseIDs <- merge(results,raw_embryo_poly_avg)
embyro_polya_wormbaseIDs <- embyro_polya_wormbaseIDs[,!c("Name")]
embyro_polya_wormbaseIDs[,gene_name = external_gene_name]
embyro_polya_wormbaseIDs[, external_gene_name = gene_name]
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs[, external_gene_name = "gene_name"]
embyro_polya_wormbaseIDs[, external_gene_name = "gene_name"]
embyro_polya_wormbaseIDs[, external_gene_name = gene_name]
embyro_polya_wormbaseIDs[, gene_name = external_gene_name]
embyro_polya_wormbaseIDs[, gene_name := external_gene_name]
View(embyro_polya_wormbaseIDs)
embyro_polya_wormbaseIDs  <- embyro_polya_wormbaseIDs [average > 5,]
table <- merge(one_cell_ribo_avg,embyro_polya_wormbaseIDs)
View(table)
table <- merge(one_cell_ribo_avg,embyro_polya_wormbaseIDs,by= gene_name]
table <- merge(one_cell_ribo_avg,embyro_polya_wormbaseIDs,by= gene_name)
table <- inner_join(one_cell_ribo_avg,embyro_polya_wormbaseIDs,by= gene_name)
View(one_cell_ribo_avg)
View(embyro_polya_wormbaseIDs)
?inner_join
table <- inner_join(one_cell_ribo_avg,embyro_polya_wormbaseIDs)
one_cell_ribo_avg <- one_cell_ribo[,average_ribo := ((one_cell_ribo[,2]+one_cell_ribo[,3])/2)]
one_cell_ribo_avg<- one_cell_ribo_avg[average >5,]
table <- inner_join(one_cell_ribo_avg,embyro_polya_wormbaseIDs)
one_cell_ribo_avg<- one_cell_ribo_avg[average_ribo >5,]
one_cell_ribo_avg <- one_cell_ribo[,average_ribo := ((one_cell_ribo[,2]+one_cell_ribo[,3])/2)]
one_cell_ribo_avg<- one_cell_ribo_avg[average_ribo >5,]
one_cell_ribo <- all_counts_diff[,c(1,6,7)]#checking with one cell stage first
one_cell_ribo_avg <- one_cell_ribo[,average_ribo := ((one_cell_ribo[,2]+one_cell_ribo[,3])/2)]
one_cell_ribo_avg<- one_cell_ribo_avg[average_ribo >5,]
table <- inner_join(one_cell_ribo_avg,embyro_polya_wormbaseIDs)
View(table)
ggplot(table, aes( x = average , y = average_ribo))  +
geom_jitter()
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_jitter()
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_histogram()
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_histogram(stat= "identity")
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)+
scale_y_log10()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)+
scale_y_log10()+
scale_x_log10()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)+
scale_y_log10()+
scale_x_binned()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)+
scale_y_log10()+
scale_x_binned(binwidth = 50)
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_jitter()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)+
scale_y_log10()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)+
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50)
scale_x_continuous()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat= "identity", binwidth = 50) +
scale_x_continuous()
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_jitter()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_bar(stat= "identity", binwidth = 50)
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_density()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_density(stat = "identity")
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_density(stat = "identity") +
scale_x_binned()
?scale_x_binned
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat = "identity") +
scale_x_binned()
>scale_x_binned()
?scale_x_binned()
ggplot(table, aes( x = (average) , y = (average_ribo)))  +
geom_histogram(stat = "identity") +
scale_x_binned(n.breaks = 50)
ggplot(table, aes( x = log2(average) , y = log2(average_ribo)))  +
geom_jitter()
cor(table$average_ribo,table$average,method = "spearman")
?topTags
write_csv(toplist,"all_genes")
View(toplist)
down_signal <- toplist[table.logFC <1.5 && table.FDR <0.05]
down_signal <- toplist[table.logFC <1.5 & table.FDR <0.05,]
View(down_signal)
down_signal <- toplist[table.logFC < (-1.5) & table.FDR <0.05,]
all_genes <- toplist[table.logCPM>1]
all_genes <- toplist[table.logCPM>1,]
down_signal <- toplist[table.logFC < (-1.5) & table.FDR <0.05,]
up_signal <- toplist[table.log]
up_signal <- toplist[table.logFC > 1.5 & table.FDR < 0.05]
write_csv(all_genes,"all_genes.csv")
write_csv(up_signal, "up_signal.csv" )
write_csv(all_genes,"all_genes.csv")
all_genes <- toplist[table.logCPM>1,]
write_csv(down_signal,"down_signal.csv")
all_genes <- toplist[table.logCPM>0,]
write_csv(all_genes,"all_genes.csv")
view(all_counts_diff)
qlf <- glmQLFTest(fit, contrast=my.contrasts[,"TE_onecellvstwocell"])
#export list of up and down regulated genes
toplist<-as.data.table(topTags(qlf, n =Inf))
all_genes <- all_counts_diff[//1cell_A.x > 0,]
all_genes <- all_counts_diff[1cell_A.x > 0,]
all_genes <- all_counts_diff[`1cell_A.x` > 0,]
all_genes <- all_counts_diff[`1cell_A.x` > 0 | `1cell_B.x`> 0|`2cell_A.x` > 0 | `2cell_B.x`> 0,]
write_csv(all_genes,"all_genes.csv")
